```
2022-11-03 
주제: 오브젝트 6-8장
참여자: @ssibongee @sanghou @lcm8728 @limm-jk
```

## 읽으면서 느낀점

- @sanghou : 예시가 Ruby로 나온게 어색했다.
  - @ssibongee : OO가 언어에 종속된 개념이 아님을 보여줄 수 있는 좋은 예시라고 생각함.
- @lcm8728 : 왜 객체지향적으로 작성하는게 변경에 유리한지, 절차지향적인 코드와 같이 비교해준 예시가 좋았음. 왜 공부하고 있는지 잘 보여준 것 같음.
- @limm-jk : 책이 말하는 정의에 매몰되지 않도록 중립적인 시야로 말해줘서 좋았음.

<br>

## 1. CQS를 왜 사용하는가

@sanghou : 쿼리가 있고 명령이 있을 수 있는데, 이를 꼭 나눠야 하는 것인지 모르겠음.

@limm-jk : 이름을 잘 지었으면 굳이 분리하지 않아도 될듯. 분리할 정도로 결합도를 낮춰야하는 대상인가

@ssibongee : 역할과 책임을 분리하는 것에 목적이 있다. 사이드 이펙트를 발생시키는 커맨드를 분리 CQS는 함수형 패러다임에 조금 더 가깝다. 사이드 이펙트를 줄이고, ….. 물론 트레이드오프도 있어서 이렇게 항상 해야한다는 아닌데 함수형 프로그래밍에서 지향하는 불변성을 얻는데 도움이 될 것 같다.

함수형에서도 모든 연산을 순수함수로만 할 수 없음을 인정함(불변 객체만 사용할 수 없음). 하지만 제한함으로 인하여 안전한 프로그램을 만들 수 있고, 멀티 스레딩 환경에서 고려할 부분을 줄일 수 있다.

@lcm8728 : 분리 → 사용하는 것은 클라이언트의 책임이 아닐까. 분리되어 있으면 이후 유연하게 사용할 수 있음. 근데 코일이 말씀하신 것처럼 디비 코스트 고려하면 생각 더 해봐야함.

CQS 참고문서 - Olive → CQS를 책에서 언급하는 어플리케이션 레벨보다 조금 더 큰 아키텍쳐적인 관점에서 보면 좋겠다.

https://martinfowler.com/bliki/CommandQuerySeparation.html

https://martinfowler.com/bliki/CQRS.html

https://learn.microsoft.com/ko-kr/azure/architecture/patterns/cqrs

<br>

## 2. `new` 해롭다

@ssibongee : 생성자도 비슷하지 않나? **어떻게 잘 쓸 수 있을까**?

@lcm8728 : 객체 생성, 메서드 호출 비즈니스 로직이라고 생각, 개별적으로 떨어져있는 비즈니스 로직을 묶어주는 애 필요 → 얘는 절차지향적일 수 밖에 없음 → 이거 하는게 서비스 레이어 → 서비스를 도메인 레이어 or 애플리케이션 레이어로 보느냐 → 애플리케이션 레이어에 좀 더 가깝다고 생각 → 도메인 레이어에서 서비스는가능한 없는게 좋음 → 상태를 가지지 않고 행위만 하는 것들을 서비스 → 클라이언트 요구사항을 녹이는 →  애플리케이션 서비스 성격이 강함 → 생성 담당하는 코드와 생성하는 시점을 결정하는 코드(클라이언트)가 분리됨

@limm-jk : `new` 의 사용은 결합도와 사용성의 트레이드 오프 → 어떻게 잘 쓸 수 있을지는 고민 중

<br>

## 3. 기능 중심의 분리

@ssibongee : 컨트롤러부터 내려가면서 개발함.

@lcm8728 : 인터페이스 영역, 도메인 영역을 따로 개발을 하고, 서비스 레이어에서 양 극단을 조합하는 형태로 개발함.

@ssibongee: 기존 책임/협력을 오염시키지 않고 새로운 기능을 추가하고 확장할 수 있을까?

- @lcm8728: OCP처럼 차후 추가될, 확장될 기능에 대해서 미리 고려해서 설계 되어있다면 좋지않을까
- @ssibongee: 사이드 이펙트를 발생시키지 않는 설계가 고려 되어 있다면 조금 더 안심하고 추가할 수 있지 않을까
- @limm-jk: 현재는 이미 기획적으로 봤을 때 확장성이 고려되어있다고 생각.
- @sanghou : 오염 시키지 않는게 가능한가? 코드를 안건드리는게 베스트. 아니면 기존 코드에서 이벤트 발행 등의 약한 결합으로 가능. 큰 단위의 책임이나 협력에서의 오염은 불가피하다고 생각함.
- @ssibongee: 이러니까 더 테스트가 중요하다는 생각이 듦
- @ssibongee: 권한 세분화는 차후 확장이 될 여지가 많기에 확장성을 고민 많이 하였다. 기존처럼 PSQL에 JSON을 떄려넣는 식이면 더 편했겠지만, 확장성을 고려하여 테이블을 분리하여 설계하도록 많이 설득했던 것 같다. 베스트라고 생각하지는 않지만 그 당시에는 최적이라고 생각.
- @lcm8728 : 떼는건 어렵지만 뭉치는건 쉽다.

